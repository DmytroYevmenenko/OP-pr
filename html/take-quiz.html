<!DOCTYPE html>
<html>
<head>
    <title>Проходження вікторини</title>
</head>
<body>
    <h1 id="title">Вікторина</h1>
    
    <a href="index.html">Головна</a>
    
    <div id="quiz"></div>
    <button onclick="checkAnswers()">Завершити</button>

    <script>
        let url = new URL(window.location.href);
        let quizId = url.searchParams.get('id');
        let quiz;

        if (quizId === null) {
            alert('Вікторину не знайдено!');
            window.location.href = 'index.html';
        }

        let quizzes = localStorage.getItem('quizzes');
        if (quizzes) {
            quizzes = JSON.parse(quizzes);
            quiz = quizzes[quizId];
            document.getElementById('title').textContent = quiz.name;
            
            let html = '';
            for (let i = 0; i < quiz.questions.length; i++) {
                html += `<div>
                    <p><strong>${i + 1}. ${quiz.questions[i].text}</strong></p>`;
                for (let j = 0; j < 4; j++) {
                    html += `<input type="radio" name="q${i}" value="${j}">
                    <label>${quiz.questions[i].options[j]}</label><br>`;
                }
                html += '</div><br>';
            }
            document.getElementById('quiz').innerHTML = html;
        }

        function checkAnswers() {
            let score = 0;
            let userAnswers = [];

            for (let i = 0; i < quiz.questions.length; i++) {
                let selected = document.querySelector(`input[name="q${i}"]:checked`);
                if (selected) {
                    let answer = parseInt(selected.value);
                    userAnswers.push(answer);
                    if (answer === quiz.questions[i].correct) {
                        score++;
                    }
                }
            }

            let result = {
                quizId: quizId,
                score: score,
                total: quiz.questions.length,
                answers: userAnswers
            };
            localStorage.setItem('lastResult', JSON.stringify(result));
            window.location.href = 'results.html';
        }
    </script>
</body>
</html>