<!DOCTYPE html>
<html>
<head>
    <title>Проходження вікторини</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1 id="title">Вікторина</h1>
        
        <nav>
            <a href="index.html">Головна</a>
        </nav>
        
        <div id="quiz"></div>
        <div class="text-center">
            <button onclick="checkAnswers()" class="btn btn-success">Завершити</button>
        </div>
    </div>

    <script>
        let url = new URL(window.location.href);
        let quizId = url.searchParams.get('id');
        let quiz;

        if (quizId === null) {
            alert('Вікторину не знайдено!');
            window.location.href = 'index.html';
        }

        let quizzes = localStorage.getItem('quizzes');
        if (quizzes) {
            quizzes = JSON.parse(quizzes);
            quiz = quizzes[quizId];
            document.getElementById('title').textContent = quiz.name;
            
            let html = '';
            for (let i = 0; i < quiz.questions.length; i++) {
                html += `<div class="question-block">
                    <p><strong>${i + 1}. ${quiz.questions[i].text}</strong></p>
                    <div class="answers-container">`;
                for (let j = 0; j < 4; j++) {
                    html += `<div class="answer-option">
                        <input type="radio" name="q${i}" value="${j}" id="q${i}_a${j}">
                        <label for="q${i}_a${j}">${quiz.questions[i].options[j]}</label>
                    </div>`;
                }
                html += '</div></div>';
            }
            document.getElementById('quiz').innerHTML = html;
        }

        function checkAnswers() {
            let score = 0;
            let userAnswers = [];

            for (let i = 0; i < quiz.questions.length; i++) {
                let selected = document.querySelector(`input[name="q${i}"]:checked`);
                if (selected) {
                    let answer = parseInt(selected.value);
                    userAnswers.push(answer);
                    if (answer === quiz.questions[i].correct) {
                        score++;
                    }
                } else {
                    userAnswers.push(null);
                }
            }

            let result = {
                quizId: quizId,
                score: score,
                total: quiz.questions.length,
                answers: userAnswers
            };
            localStorage.setItem('lastResult', JSON.stringify(result));
            window.location.href = 'results.html';
        }
    </script>
</body>
</html>